# 思维导图AI助手 - 恢复到原始弹窗版本

## 🔄 **恢复操作完成**

已成功将思维导图AI助手从分屏模式恢复到原始的弹窗版本。

## ✅ **已完成的恢复操作**

### **1. 恢复popup.js**
- ✅ 移除了分屏模式相关代码
- ✅ 恢复了原始的generateMindmap方法
- ✅ 移除了background消息监听
- ✅ 删除了分屏模式相关的方法

### **2. 删除分屏相关文件**
- ✅ 删除了 `extension/content.js`
- ✅ 删除了 `extension/background.js`
- ✅ 删除了 `extension/SPLIT_SCREEN_TEST_GUIDE.md`
- ✅ 删除了 `extension/REFRESH_STATE_RECOVERY_FIX.md`

### **3. 更新manifest.json**
- ✅ 移除了 `webNavigation` 权限
- ✅ 移除了 `content_scripts` 配置
- ✅ 移除了 `background` 配置
- ✅ 移除了 `web_accessible_resources` 配置
- ✅ 清理了重复的icons配置

## 🎯 **当前功能状态**

### **恢复的功能**
- **弹窗模式**：点击扩展图标显示弹窗界面
- **网页内容提取**：自动提取当前网页内容
- **思维导图生成**：在弹窗中生成和显示思维导图
- **导出功能**：支持PNG、SVG、PDF导出
- **AI对话**：支持与AI进行对话
- **设置保存**：保存用户设置和偏好

### **移除的功能**
- **分屏模式**：不再支持页面内嵌分屏显示
- **状态持久化**：不再保存页面刷新后的状态
- **拖拽调整**：不再支持拖拽调整面板宽度

## 🚀 **使用方法**

### **基本使用流程**
1. **打开弹窗**：点击浏览器工具栏中的思维导图AI助手图标
2. **查看内容**：弹窗会自动提取当前网页内容
3. **生成思维导图**：点击"生成思维导图"按钮
4. **查看结果**：思维导图会在弹窗中显示
5. **导出功能**：使用导出按钮保存思维导图

### **功能特点**
- **简洁界面**：弹窗模式界面简洁，操作直观
- **快速生成**：直接调用API生成思维导图
- **即时显示**：生成结果立即在弹窗中显示
- **完整功能**：保留所有核心功能

## 📋 **技术架构**

### **当前架构**
```
浏览器扩展
├── popup.html (弹窗界面)
├── popup.js (主要逻辑)
├── popup.css (样式文件)
├── manifest.json (配置文件)
└── icons/ (图标文件)
```

### **通信方式**
- **API调用**：直接通过fetch调用后端API
- **本地存储**：使用chrome.storage保存设置
- **网页交互**：通过chrome.tabs API获取网页内容

## 🔧 **开发说明**

### **文件结构**
```
extension/
├── popup.html          # 弹窗HTML
├── popup.js           # 主要JavaScript逻辑
├── popup.css          # 样式文件
├── manifest.json      # 扩展配置文件
├── icons/             # 图标文件夹
│   ├── icon16.png
│   ├── icon32.png
│   ├── icon48.png
│   └── icon128.png
└── README.md          # 说明文档
```

### **核心类**
- **MindmapAIExtension**：主要的扩展类，处理所有功能

### **主要方法**
- **generateMindmap()**：生成思维导图
- **renderMindmap()**：渲染思维导图
- **loadPageContent()**：加载网页内容
- **exportToPNG()**：导出PNG格式
- **exportToSVG()**：导出SVG格式
- **exportToPDF()**：导出PDF格式

## 🧪 **测试建议**

### **功能测试**
1. **基础功能**：
   - 打开弹窗
   - 生成思维导图
   - 查看显示效果

2. **导出功能**：
   - 测试PNG导出
   - 测试SVG导出
   - 测试PDF导出

3. **设置功能**：
   - 测试AI提供商切换
   - 测试模型选择
   - 测试设置保存

### **兼容性测试**
- Chrome浏览器
- Edge浏览器
- 不同版本的浏览器

## 📝 **注意事项**

### **使用限制**
- **弹窗大小**：受浏览器弹窗大小限制
- **内容滚动**：长内容需要滚动查看
- **状态保持**：关闭弹窗后状态不保持

### **性能考虑**
- **内存使用**：弹窗模式内存使用较少
- **加载速度**：启动速度较快
- **资源占用**：资源占用较少

## 🎉 **恢复完成**

思维导图AI助手已成功恢复到原始的弹窗版本，所有核心功能都已恢复，可以正常使用。用户现在可以通过点击扩展图标来打开弹窗，生成和查看思维导图。

